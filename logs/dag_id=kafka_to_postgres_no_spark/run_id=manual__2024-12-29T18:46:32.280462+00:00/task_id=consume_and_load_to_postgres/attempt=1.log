[2024-12-29T18:46:32.997+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: kafka_to_postgres_no_spark.consume_and_load_to_postgres manual__2024-12-29T18:46:32.280462+00:00 [queued]>
[2024-12-29T18:46:33.007+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: kafka_to_postgres_no_spark.consume_and_load_to_postgres manual__2024-12-29T18:46:32.280462+00:00 [queued]>
[2024-12-29T18:46:33.007+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 2
[2024-12-29T18:46:33.019+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): consume_and_load_to_postgres> on 2024-12-29 18:46:32.280462+00:00
[2024-12-29T18:46:33.023+0000] {standard_task_runner.py:57} INFO - Started process 64 to run task
[2024-12-29T18:46:33.026+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'kafka_to_postgres_no_spark', 'consume_and_load_to_postgres', 'manual__2024-12-29T18:46:32.280462+00:00', '--job-id', '99', '--raw', '--subdir', 'DAGS_FOLDER/kafka_to_postgres_team2_dag.py', '--cfg-path', '/tmp/tmp3m9gusmx']
[2024-12-29T18:46:33.028+0000] {standard_task_runner.py:85} INFO - Job 99: Subtask consume_and_load_to_postgres
[2024-12-29T18:46:33.100+0000] {task_command.py:410} INFO - Running <TaskInstance: kafka_to_postgres_no_spark.consume_and_load_to_postgres manual__2024-12-29T18:46:32.280462+00:00 [running]> on host 7a0a84882d0c
[2024-12-29T18:46:33.161+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='kafka_to_postgres_no_spark' AIRFLOW_CTX_TASK_ID='consume_and_load_to_postgres' AIRFLOW_CTX_EXECUTION_DATE='2024-12-29T18:46:32.280462+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-29T18:46:32.280462+00:00'
[2024-12-29T18:46:33.164+0000] {conn.py:381} INFO - <BrokerConnection node_id=bootstrap-0 host=kafka-learn:9092 <connecting> [IPv4 ('172.18.0.7', 9092)]>: connecting to kafka-learn:9092 [('172.18.0.7', 9092) IPv4]
[2024-12-29T18:46:33.164+0000] {conn.py:1205} INFO - Probing node bootstrap-0 broker version
[2024-12-29T18:46:33.165+0000] {conn.py:410} INFO - <BrokerConnection node_id=bootstrap-0 host=kafka-learn:9092 <connecting> [IPv4 ('172.18.0.7', 9092)]>: Connection complete.
[2024-12-29T18:46:33.282+0000] {conn.py:1267} INFO - Broker version identified as 2.5.0
[2024-12-29T18:46:33.282+0000] {conn.py:1269} INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
[2024-12-29T18:46:33.283+0000] {subscription_state.py:171} INFO - Updating subscribed topics to: ('teams',)
[2024-12-29T18:46:33.294+0000] {cluster.py:371} INFO - Group coordinator for nba_teams_loader is ('coordinator-1', 'kafka', 9092, None)
[2024-12-29T18:46:33.295+0000] {base.py:694} INFO - Discovered coordinator coordinator-1 for group nba_teams_loader
[2024-12-29T18:46:33.295+0000] {base.py:741} INFO - Starting new heartbeat thread
[2024-12-29T18:46:33.296+0000] {consumer.py:349} INFO - Revoking previously assigned partitions () for group nba_teams_loader
[2024-12-29T18:46:33.297+0000] {conn.py:381} INFO - <BrokerConnection node_id=coordinator-1 host=kafka:9092 <connecting> [IPv4 ('172.18.0.7', 9092)]>: connecting to kafka:9092 [('172.18.0.7', 9092) IPv4]
[2024-12-29T18:46:33.297+0000] {conn.py:410} INFO - <BrokerConnection node_id=coordinator-1 host=kafka:9092 <connecting> [IPv4 ('172.18.0.7', 9092)]>: Connection complete.
[2024-12-29T18:46:33.297+0000] {conn.py:919} INFO - <BrokerConnection node_id=bootstrap-0 host=kafka-learn:9092 <connected> [IPv4 ('172.18.0.7', 9092)]>: Closing connection. 
[2024-12-29T18:46:33.400+0000] {base.py:450} INFO - (Re-)joining group nba_teams_loader
[2024-12-29T18:46:36.431+0000] {base.py:522} INFO - Elected group leader -- performing partition assignments using range
[2024-12-29T18:46:36.434+0000] {conn.py:381} INFO - <BrokerConnection node_id=1 host=kafka:9092 <connecting> [IPv4 ('172.18.0.7', 9092)]>: connecting to kafka:9092 [('172.18.0.7', 9092) IPv4]
[2024-12-29T18:46:36.435+0000] {conn.py:410} INFO - <BrokerConnection node_id=1 host=kafka:9092 <connecting> [IPv4 ('172.18.0.7', 9092)]>: Connection complete.
[2024-12-29T18:46:36.462+0000] {base.py:336} INFO - Successfully joined group nba_teams_loader with generation 1
[2024-12-29T18:46:36.462+0000] {subscription_state.py:257} INFO - Updated partition assignment: [('teams', 0)]
[2024-12-29T18:46:36.462+0000] {consumer.py:246} INFO - Setting newly assigned partitions (('teams', 0),) for group nba_teams_loader
[2024-12-29T18:46:36.482+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612737, 'full_name': 'Atlanta Hawks', 'abbreviation': 'ATL', 'nickname': 'Hawks', 'city': 'Atlanta', 'state': 'Atlanta', 'year_founded': 1949}
[2024-12-29T18:46:36.487+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612737, 'ATL', 'Atlanta', 'Atlanta Hawks', 'Atlanta', 1949)
[2024-12-29T18:46:36.487+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612738, 'full_name': 'Boston Celtics', 'abbreviation': 'BOS', 'nickname': 'Celtics', 'city': 'Boston', 'state': 'Massachusetts', 'year_founded': 1946}
[2024-12-29T18:46:36.489+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612738, 'BOS', 'Boston', 'Boston Celtics', 'Massachusetts', 1946)
[2024-12-29T18:46:36.489+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612739, 'full_name': 'Cleveland Cavaliers', 'abbreviation': 'CLE', 'nickname': 'Cavaliers', 'city': 'Cleveland', 'state': 'Ohio', 'year_founded': 1970}
[2024-12-29T18:46:36.491+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612739, 'CLE', 'Cleveland', 'Cleveland Cavaliers', 'Ohio', 1970)
[2024-12-29T18:46:36.491+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612740, 'full_name': 'New Orleans Pelicans', 'abbreviation': 'NOP', 'nickname': 'Pelicans', 'city': 'New Orleans', 'state': 'Louisiana', 'year_founded': 2002}
[2024-12-29T18:46:36.493+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612740, 'NOP', 'New Orleans', 'New Orleans Pelicans', 'Louisiana', 2002)
[2024-12-29T18:46:36.493+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612741, 'full_name': 'Chicago Bulls', 'abbreviation': 'CHI', 'nickname': 'Bulls', 'city': 'Chicago', 'state': 'Illinois', 'year_founded': 1966}
[2024-12-29T18:46:36.495+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612741, 'CHI', 'Chicago', 'Chicago Bulls', 'Illinois', 1966)
[2024-12-29T18:46:36.495+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612742, 'full_name': 'Dallas Mavericks', 'abbreviation': 'DAL', 'nickname': 'Mavericks', 'city': 'Dallas', 'state': 'Texas', 'year_founded': 1980}
[2024-12-29T18:46:36.497+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612742, 'DAL', 'Dallas', 'Dallas Mavericks', 'Texas', 1980)
[2024-12-29T18:46:36.497+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612743, 'full_name': 'Denver Nuggets', 'abbreviation': 'DEN', 'nickname': 'Nuggets', 'city': 'Denver', 'state': 'Colorado', 'year_founded': 1976}
[2024-12-29T18:46:36.499+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612743, 'DEN', 'Denver', 'Denver Nuggets', 'Colorado', 1976)
[2024-12-29T18:46:36.499+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612744, 'full_name': 'Golden State Warriors', 'abbreviation': 'GSW', 'nickname': 'Warriors', 'city': 'Golden State', 'state': 'California', 'year_founded': 1946}
[2024-12-29T18:46:36.501+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612744, 'GSW', 'Golden State', 'Golden State Warriors', 'California', 1946)
[2024-12-29T18:46:36.501+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612745, 'full_name': 'Houston Rockets', 'abbreviation': 'HOU', 'nickname': 'Rockets', 'city': 'Houston', 'state': 'Texas', 'year_founded': 1967}
[2024-12-29T18:46:36.502+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612745, 'HOU', 'Houston', 'Houston Rockets', 'Texas', 1967)
[2024-12-29T18:46:36.503+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612746, 'full_name': 'Los Angeles Clippers', 'abbreviation': 'LAC', 'nickname': 'Clippers', 'city': 'Los Angeles', 'state': 'California', 'year_founded': 1970}
[2024-12-29T18:46:36.504+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612746, 'LAC', 'Los Angeles', 'Los Angeles Clippers', 'California', 1970)
[2024-12-29T18:46:36.504+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612747, 'full_name': 'Los Angeles Lakers', 'abbreviation': 'LAL', 'nickname': 'Lakers', 'city': 'Los Angeles', 'state': 'California', 'year_founded': 1948}
[2024-12-29T18:46:36.506+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612747, 'LAL', 'Los Angeles', 'Los Angeles Lakers', 'California', 1948)
[2024-12-29T18:46:36.506+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612748, 'full_name': 'Miami Heat', 'abbreviation': 'MIA', 'nickname': 'Heat', 'city': 'Miami', 'state': 'Florida', 'year_founded': 1988}
[2024-12-29T18:46:36.508+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612748, 'MIA', 'Miami', 'Miami Heat', 'Florida', 1988)
[2024-12-29T18:46:36.508+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612749, 'full_name': 'Milwaukee Bucks', 'abbreviation': 'MIL', 'nickname': 'Bucks', 'city': 'Milwaukee', 'state': 'Wisconsin', 'year_founded': 1968}
[2024-12-29T18:46:36.509+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612749, 'MIL', 'Milwaukee', 'Milwaukee Bucks', 'Wisconsin', 1968)
[2024-12-29T18:46:36.509+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612750, 'full_name': 'Minnesota Timberwolves', 'abbreviation': 'MIN', 'nickname': 'Timberwolves', 'city': 'Minnesota', 'state': 'Minnesota', 'year_founded': 1989}
[2024-12-29T18:46:36.511+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612750, 'MIN', 'Minnesota', 'Minnesota Timberwolves', 'Minnesota', 1989)
[2024-12-29T18:46:36.511+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612751, 'full_name': 'Brooklyn Nets', 'abbreviation': 'BKN', 'nickname': 'Nets', 'city': 'Brooklyn', 'state': 'New York', 'year_founded': 1976}
[2024-12-29T18:46:36.512+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612751, 'BKN', 'Brooklyn', 'Brooklyn Nets', 'New York', 1976)
[2024-12-29T18:46:36.512+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612752, 'full_name': 'New York Knicks', 'abbreviation': 'NYK', 'nickname': 'Knicks', 'city': 'New York', 'state': 'New York', 'year_founded': 1946}
[2024-12-29T18:46:36.514+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612752, 'NYK', 'New York', 'New York Knicks', 'New York', 1946)
[2024-12-29T18:46:36.514+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612753, 'full_name': 'Orlando Magic', 'abbreviation': 'ORL', 'nickname': 'Magic', 'city': 'Orlando', 'state': 'Florida', 'year_founded': 1989}
[2024-12-29T18:46:36.515+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612753, 'ORL', 'Orlando', 'Orlando Magic', 'Florida', 1989)
[2024-12-29T18:46:36.515+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612754, 'full_name': 'Indiana Pacers', 'abbreviation': 'IND', 'nickname': 'Pacers', 'city': 'Indiana', 'state': 'Indiana', 'year_founded': 1976}
[2024-12-29T18:46:36.517+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612754, 'IND', 'Indiana', 'Indiana Pacers', 'Indiana', 1976)
[2024-12-29T18:46:36.517+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612755, 'full_name': 'Philadelphia 76ers', 'abbreviation': 'PHI', 'nickname': '76ers', 'city': 'Philadelphia', 'state': 'Pennsylvania', 'year_founded': 1949}
[2024-12-29T18:46:36.518+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612755, 'PHI', 'Philadelphia', 'Philadelphia 76ers', 'Pennsylvania', 1949)
[2024-12-29T18:46:36.518+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612756, 'full_name': 'Phoenix Suns', 'abbreviation': 'PHX', 'nickname': 'Suns', 'city': 'Phoenix', 'state': 'Arizona', 'year_founded': 1968}
[2024-12-29T18:46:36.520+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612756, 'PHX', 'Phoenix', 'Phoenix Suns', 'Arizona', 1968)
[2024-12-29T18:46:36.520+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612757, 'full_name': 'Portland Trail Blazers', 'abbreviation': 'POR', 'nickname': 'Trail Blazers', 'city': 'Portland', 'state': 'Oregon', 'year_founded': 1970}
[2024-12-29T18:46:36.521+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612757, 'POR', 'Portland', 'Portland Trail Blazers', 'Oregon', 1970)
[2024-12-29T18:46:36.521+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612758, 'full_name': 'Sacramento Kings', 'abbreviation': 'SAC', 'nickname': 'Kings', 'city': 'Sacramento', 'state': 'California', 'year_founded': 1948}
[2024-12-29T18:46:36.523+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612758, 'SAC', 'Sacramento', 'Sacramento Kings', 'California', 1948)
[2024-12-29T18:46:36.523+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612759, 'full_name': 'San Antonio Spurs', 'abbreviation': 'SAS', 'nickname': 'Spurs', 'city': 'San Antonio', 'state': 'Texas', 'year_founded': 1976}
[2024-12-29T18:46:36.524+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612759, 'SAS', 'San Antonio', 'San Antonio Spurs', 'Texas', 1976)
[2024-12-29T18:46:36.524+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612760, 'full_name': 'Oklahoma City Thunder', 'abbreviation': 'OKC', 'nickname': 'Thunder', 'city': 'Oklahoma City', 'state': 'Oklahoma', 'year_founded': 1967}
[2024-12-29T18:46:36.526+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612760, 'OKC', 'Oklahoma City', 'Oklahoma City Thunder', 'Oklahoma', 1967)
[2024-12-29T18:46:36.526+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612761, 'full_name': 'Toronto Raptors', 'abbreviation': 'TOR', 'nickname': 'Raptors', 'city': 'Toronto', 'state': 'Ontario', 'year_founded': 1995}
[2024-12-29T18:46:36.527+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612761, 'TOR', 'Toronto', 'Toronto Raptors', 'Ontario', 1995)
[2024-12-29T18:46:36.527+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612762, 'full_name': 'Utah Jazz', 'abbreviation': 'UTA', 'nickname': 'Jazz', 'city': 'Utah', 'state': 'Utah', 'year_founded': 1974}
[2024-12-29T18:46:36.529+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612762, 'UTA', 'Utah', 'Utah Jazz', 'Utah', 1974)
[2024-12-29T18:46:36.529+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612763, 'full_name': 'Memphis Grizzlies', 'abbreviation': 'MEM', 'nickname': 'Grizzlies', 'city': 'Memphis', 'state': 'Tennessee', 'year_founded': 1995}
[2024-12-29T18:46:36.530+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612763, 'MEM', 'Memphis', 'Memphis Grizzlies', 'Tennessee', 1995)
[2024-12-29T18:46:36.530+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612764, 'full_name': 'Washington Wizards', 'abbreviation': 'WAS', 'nickname': 'Wizards', 'city': 'Washington', 'state': 'District of Columbia', 'year_founded': 1961}
[2024-12-29T18:46:36.532+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612764, 'WAS', 'Washington', 'Washington Wizards', 'District of Columbia', 1961)
[2024-12-29T18:46:36.532+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612765, 'full_name': 'Detroit Pistons', 'abbreviation': 'DET', 'nickname': 'Pistons', 'city': 'Detroit', 'state': 'Michigan', 'year_founded': 1948}
[2024-12-29T18:46:36.533+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612765, 'DET', 'Detroit', 'Detroit Pistons', 'Michigan', 1948)
[2024-12-29T18:46:36.533+0000] {logging_mixin.py:150} INFO - Consuming message: {'id': 1610612766, 'full_name': 'Charlotte Hornets', 'abbreviation': 'CHA', 'nickname': 'Hornets', 'city': 'Charlotte', 'state': 'North Carolina', 'year_founded': 1988}
[2024-12-29T18:46:36.534+0000] {logging_mixin.py:150} INFO - Inserted team into PostgreSQL: (1610612766, 'CHA', 'Charlotte', 'Charlotte Hornets', 'North Carolina', 1988)
[2024-12-29T18:50:04.624+0000] {local_task_job_runner.py:292} WARNING - State of this instance has been externally set to success. Terminating instance.
[2024-12-29T18:50:04.628+0000] {process_utils.py:135} INFO - Sending Signals.SIGTERM to group 64. PIDs of all processes in the group: [64]
[2024-12-29T18:50:04.629+0000] {process_utils.py:86} INFO - Sending the signal Signals.SIGTERM to group 64
[2024-12-29T18:50:04.630+0000] {taskinstance.py:1517} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-12-29T18:50:04.632+0000] {logging_mixin.py:150} INFO - Error connecting to PostgreSQL or consuming Kafka messages: Task received SIGTERM signal
[2024-12-29T18:50:04.646+0000] {base.py:748} INFO - Stopping heartbeat thread
[2024-12-29T18:50:04.647+0000] {base.py:773} INFO - Leaving consumer group (nba_teams_loader).
[2024-12-29T18:50:04.682+0000] {conn.py:919} INFO - <BrokerConnection node_id=coordinator-1 host=kafka:9092 <connected> [IPv4 ('172.18.0.7', 9092)]>: Closing connection. 
[2024-12-29T18:50:04.683+0000] {conn.py:919} INFO - <BrokerConnection node_id=1 host=kafka:9092 <connected> [IPv4 ('172.18.0.7', 9092)]>: Closing connection. 
[2024-12-29T18:50:04.683+0000] {future.py:79} ERROR - Fetch to node 1 failed: Cancelled: <BrokerConnection node_id=1 host=kafka:9092 <connected> [IPv4 ('172.18.0.7', 9092)]>
[2024-12-29T18:50:04.683+0000] {python.py:183} INFO - Done. Returned value was: None
[2024-12-29T18:50:04.693+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=kafka_to_postgres_no_spark, task_id=consume_and_load_to_postgres, execution_date=20241229T184632, start_date=20241229T184632, end_date=20241229T185004
[2024-12-29T18:50:04.727+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=64, status='terminated', exitcode=0, started='18:46:32') (64) terminated with exit code 0
